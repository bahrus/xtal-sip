(function(){const a=customElements.define;customElements.define=(c,d)=>{const e=b.getLookup(c);e&&Object.assign(d,e.element.dataset),a(c,d)};class b extends HTMLElement{static get is(){return'xtal-sip'}replaceAll(a,b,c){return a.replace(new RegExp(b,'g'),c)}static getLookup(a){if(b._lookupMap){const c=b._lookupMap[a];if(c)if(1<c.length)throw'Duplicate tagname found: '+a;else return c[0]}}static loadDependencies(a){a.forEach((a)=>b.loadDependency(a))}static loadDependency(a){b._alreadyAdded[a]=!0;const c=this.getLookup(a);if(!c)return;if(b._alreadyLoaded[c.path])return;if(customElements.get(a))return;let d,e=document.head;c.isScript?(d=document.createElement('script'),d.src=c.path):c.isCCRef?(d=document.createElement('c-c'),d.setAttribute('href',c.path),e=document.body):(d=document.createElement('link'),d.setAttribute('rel','import'),d.setAttribute('href',c.path)),c.async&&d.setAttribute('async',''),setTimeout(()=>{e.appendChild(d)},50)}qsa(a,b){return[].slice.call((b?b:this).querySelectorAll(a))}get_h(){for(let a=this.parentElement;a;){if(a.shadowRoot)return a.shadowRoot;a=a.parentElement}return document.body}process_h(a){if(a){const c=b._lookupMap;for(const a in b._alreadyAdded)delete c[a];for(const d in b._alreadyAdded={},c){if(b._alreadyAdded[d])continue;const c=b.getLookup(d);if(c.preemptive){b.loadDependency(d);continue}a.querySelector(d)&&b.loadDependency(d)}}}connectedCallback(){if(!b._lookupMap){b._lookupMap={};const c={};this.qsa('link[rel-ish="preload"]',document.head).forEach((a)=>{b._substitutor&&b._substitutor(a),a.dataset.tags.split(',').forEach((b)=>{c[b]||(c[b]=[]),c[b].push(a)})});const d=[];for(var a in c){const e=c[a];let f;if(1===e.length?f=e[0]:b._tieBreaker&&(f=b._tieBreaker(a,e)),f){if(f.alreadyAdded)continue;f.alreadyAdded=!0,d.push(f)}}d.forEach((a)=>{const b=a.dataset.async!==void 0,c=a.getAttribute('href');a.dataset.tags.split(',').forEach((b)=>{let d=c,e=0;b.split('-').forEach((a)=>{d=this.replaceAll(d,'\\{'+e+'\\}',a),e++});let f=a.dataset.base;if(!f){const b=a.dataset.baseRef;b&&(f=document.getElementById(b).dataset.base)}f||(f=''),d=f+d;const g=document.createElement('link');g.href=d,g.rel='preload',g.setAttribute('as',a.getAttribute('as')),g.dataset.tag=b,Object.assign(g.dataset,a.dataset),document.head.appendChild(g)})}),this.qsa('link[rel="preload"][data-tag]',document.head).forEach((a)=>{const c=a.dataset.tag;const d={path:a.getAttribute('href'),async:a.dataset.async!==void 0,isScript:'script'===a.getAttribute('as'),isCCRef:'c-c'===a.dataset.importer,preemptive:a.dataset.preemptive!==void 0,element:a},e=b._lookupMap[c];e||(b._lookupMap[c]=[]),b._lookupMap[c].push(d)})}const c=this.getAttribute('load');c?c.split(',').forEach((a)=>{b.loadDependency(a)}):this.process_h(this.parentElement)}}b._alreadyAdded={},b._alreadyLoaded={},b.useJITLoading=!1;const c={};document.head.dispatchEvent(new CustomEvent('xtal-sip-init',{detail:c})),b._tieBreaker=c.tieBreaker,b._substitutor=c.substitutor,customElements.define('xtal-sip',b),document.addEventListener('DOMContentLoaded',()=>{const a=document.createElement('xtal-sip');a.setAttribute('load','dom-bind'),document.body.appendChild(a)})})();